![log-flume-logo](https://cloud.githubusercontent.com/assets/1636310/24171665/407f51a2-0e7d-11e7-974f-f80e0c45e1ed.jpg)

This allows developers to sync WordPress media libraries between machines over Amazon S3.

It can also be used for backing up websites or even moving websites between servers

### How Log Flume talks to S3

The setup will ask you to add these constants to your wp-config.php file:

- LOG_FLUME_REGION
- LOG_FLUME_ACCESS_KEY_ID
- LOG_FLUME_SECRET_ACCESS_KEY

You can obtain these details by creating an IAM user. Here is [our guide](https://github.com/logsmith/log-flume/wiki/Getting-AWS-credentials) on how to setup an IAM Amazon user and get the access and secret key that you need.

# Installation

#### 1. Add the Wordpress plugin to your composer file by navigating to your project and running this inside a terminal:

```
composer require logsmith/log-flume
```

#### 2. Activate the plugin via the admin interface, or just run:

```
wp plugin activate log-flume
```

#### 3. Add your credentials to your wp-config file.

And these constants to your wp-config file:

```
define('LOG_FLUME_REGION','eu-west-2'); //London
define('LOG_FLUME_ACCESS_KEY_ID','');
define('LOG_FLUME_SECRET_ACCESS_KEY','');
```

#### 4. Then finally run (you will need the constants above):

```
wp logflume check_credentials
```

#### 5. If the check is successfull, you can start the log flume setup:

```
wp logflume setup <bucket_name>
```

`bucket_name` is usually the address of the site you are currently working on ('website.local')

You will also be asked `Create bucket? [y/n]` - supply 'y' if this is a fresh setup. Select N

#### 6. Time to sync!

```
wp logflume sync
```

Bucket name is usually the address of the site you are currently using



# Functions

**logflume backup**
> This function runs `sync` and a DB backup.

**logflume check_credentials**
> Performs a simple S3 function to make sure it can access the selected bucket

**logflume setup <bucket_name [--expiry=<number-of-days>]>**
> Created the required bucket and bucket settings for handling media and sql backups.

# Help!

### Setting up a cronjob



```
/usr/local/bin/wp logflume backup --path=/path/to/www.website.co.uk
```



### Troubleshooting

Are you receiving an error similar to `PHP Fatal error:  Uncaught Error: Class 'Aws\S3\S3Client' not found in /path/to/file`

Make sure you are requiring your autoload.php generated by composer. We usually add this to the top of our wp-config file:

```
require( dirname( __FILE__ ) . '/vendor/autoload.php' );
```
